<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dying Light 2 Settings Editor</title>
    <style>
        :root {
            --bg-color-light: #f8f9fa;
            --text-color-light: #212529;
            --container-bg-light: #ffffff;
            --border-color-light: #dee2e6;
            --input-bg-light: #fff;
            --primary-color: #0d6efd;
            --primary-color-hover: #0b5ed7;
            --success-color: #198754;
            --success-bg-light: #d1e7dd;
            --error-color: #dc3545;

            --bg-color-dark: #121212;
            --text-color-dark: #e9ecef;
            --container-bg-dark: #1e1e1e;
            --border-color-dark: #495057;
            --input-bg-dark: #2c2f33;
            --success-bg-dark: #0a3622;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            margin: 20px;
            background-color: var(--bg-color-light);
            color: var(--text-color-light);
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: var(--bg-color-dark);
            color: var(--text-color-dark);
        }

        .container {
            background-color: var(--container-bg-light);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            max-width: 800px;
            margin: auto;
            position: relative;
            border: 1px solid var(--border-color-light);
        }

        body.dark-mode .container {
            background-color: var(--container-bg-dark);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-color-dark);
        }

        h1 {
            text-align: center;
            color: var(--text-color-light);
            margin-bottom: 30px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        body.dark-mode h1 {
            color: var(--text-color-dark);
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        .theme-toggle:hover {
            background-color: var(--primary-color-hover);
        }

        .setting-section {
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border-color-light);
            padding-bottom: 1rem;
        }

        body.dark-mode .setting-section {
            border-bottom-color: var(--border-color-dark);
        }

        .setting-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .setting-section h2 {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.25rem;
            font-weight: 500;
            margin: 0 0 1rem 0;
        }

        .setting-section h2::after {
            content: '\25B8';
            /* Right-pointing triangle */
            font-size: 0.8em;
            transition: transform 0.2s ease-in-out;
        }

        .setting-section.open h2::after {
            transform: rotate(90deg);
        }

        .settings-content {
            display: none;
            padding-left: 1rem;
            border-left: 2px solid var(--primary-color);
        }

        .setting-section.open .settings-content {
            display: block;
        }


        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 8px 0;
        }

        .setting-item label {
            flex: 1;
            margin-right: 15px;
            font-weight: 500;
            display: flex;
            align-items: center;
        }

        .tooltip-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background-color: #e9ecef;
            color: #495057;
            text-align: center;
            font-size: 12px;
            line-height: 18px;
            cursor: help;
            margin-left: 8px;
            position: relative;
            font-weight: bold;
            vertical-align: middle;
        }

        body.dark-mode .tooltip-icon {
            background-color: #495057;
            color: #e9ecef;
        }

        .tooltip-icon::after {
            content: attr(data-tooltip);
            position: absolute;
            visibility: hidden;
            opacity: 0;
            z-index: 10;
            bottom: 135%;
            left: 50%;
            transform: translateX(-50%);
            white-space: normal;
            width: 250px;
            background-color: #212529;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            font-weight: normal;
            font-size: 14px;
            transition: opacity 0.2s, visibility 0.2s;
            pointer-events: none;
        }

        .tooltip-icon:hover::after {
            visibility: visible;
            opacity: 1;
        }

        .setting-item input[type="number"],
        .setting-item input[type="text"],
        .setting-item select {
            flex: 2;
            padding: 10px;
            border: 1px solid var(--border-color-light);
            border-radius: 6px;
            font-size: 14px;
            background-color: var(--input-bg-light);
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .setting-item input:focus,
        .setting-item select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.25);
        }

        body.dark-mode .setting-item input[type="number"],
        body.dark-mode .setting-item input[type="text"],
        body.dark-mode .setting-item select {
            background-color: var(--input-bg-dark);
            border-color: var(--border-color-dark);
            color: var(--text-color-dark);
        }

        .setting-item input[type="range"] {
            flex: 2;
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
        }

        body.dark-mode .setting-item input[type="range"] {
            background: #444;
        }

        .setting-item input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
        }

        .button-container {
            text-align: center;
            margin-top: 30px;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: var(--primary-color-hover);
        }

        .file-path {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9em;
            color: #6c757d;
        }

        body.dark-mode .file-path {
            color: #adb5bd;
        }

        .drop-area {
            border: 2px dashed var(--border-color-light);
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
            background-color: #fdfdff;
            color: #555;
            transition: border-color 0.3s ease, background-color 0.3s ease;
            font-size: 1.1em;
        }

        body.dark-mode .drop-area {
            border-color: var(--border-color-dark);
            background-color: #212121;
            color: #aaa;
        }

        .drop-area.highlight {
            border-color: var(--primary-color);
            background-color: #eef5ff;
        }

        body.dark-mode .drop-area.highlight {
            background-color: #2a2a3a;
        }

        .drop-area.success {
            border-color: var(--success-color);
            background-color: var(--success-bg-light);
            color: var(--success-color);
        }

        body.dark-mode .drop-area.success {
            background-color: var(--success-bg-dark);
        }

        .feedback-message {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }

        .feedback-message.success {
            color: var(--success-color);
        }

        .feedback-message.error {
            color: var(--error-color);
        }

        .search-bar-container {
            width: 100%;
            margin-bottom: 20px;
        }

        .search-bar-container input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color-light);
            border-radius: 6px;
            font-size: 16px;
            box-sizing: border-box;
        }

        body.dark-mode .search-bar-container input[type="text"] {
            background-color: var(--input-bg-dark);
            border-color: var(--border-color-dark);
            color: var(--text-color-dark);
        }

        .search-bar-container input[type="text"]::placeholder {
            color: #6c757d;
        }

        .search-bar-container input[type="text"]:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.25);
            outline: none;
        }

        .default-config-bar {
            width: 100%;
            padding: 10px;
            background-color: var(--success-bg-light);
            color: var(--success-color);
            border-radius: 5px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
        }

        body.dark-mode .default-config-bar {
            background-color: var(--success-bg-dark);
            color: #7ee2a8;
        }



        .controls-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }

        .expand-all-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        .expand-all-btn:hover {
            background-color: var(--primary-color-hover);
        }
    </style>
</head>

<body class="dark-mode">
    <div class="container">
        <button id="themeToggle" class="theme-toggle">Toggle Theme</button>
        <h1>Dying Light 2 Settings Editor</h1>

        <div class="drop-area" id="dropArea">
            Drag and drop your `video.scr` file anywhere on the page, or click here to select.
            <input type="file" id="fileInput" accept=".scr" style="display: none;">
        </div>
        <div class="feedback-message" id="feedbackMessage"></div>

        <div class="default-config-bar" id="defaultConfigLoadedBar" style="display: none;">
            Default configuration loaded.
        </div>

        <div class="search-bar-container">
            <input type="text" id="settingSearch" placeholder="Search settings...">
        </div>

        <div class="controls-bar">
            <button id="expandAllBtn" class="expand-all-btn">Show All Categories</button>
        </div>

        <div class="setting-section">
            <h2>Display Settings</h2>
            <div class="settings-content">
                <div class="setting-item">
                    <label for="windowMode">Window Mode<span class="tooltip-icon"
                            data-tooltip="Sets the display mode for the game window: Windowed, Borderless, or Fullscreen.">?</span></label>
                    <select id="windowMode">
                        <option value="0">Windowed</option>
                        <option value="1">Borderless</option>
                        <option value="2">Fullscreen</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="windowOffsetX">Window Offset X<span class="tooltip-icon"
                            data-tooltip="Sets the window's horizontal position in pixels. Only applies in Windowed or Borderless modes.">?</span></label>
                    <input type="number" id="windowOffsetX" value="0">
                </div>
                <div class="setting-item">
                    <label for="windowOffsetY">Window Offset Y<span class="tooltip-icon"
                            data-tooltip="Sets the window's vertical position in pixels. Only applies in Windowed or Borderless modes.">?</span></label>
                    <input type="number" id="windowOffsetY" value="0">
                </div>
                <div class="setting-item">
                    <label for="resolution">Resolution (Primary Monitor)<span class="tooltip-icon"
                            data-tooltip="Sets the primary display resolution for the game.">?</span></label>
                    <select id="resolution">
                        <option value="1280,720">1280x720 (720p)</option>
                        <option value="1920,1080">1920x1080 (1080p)</option>
                        <option value="2560,1440">2560x1440 (1440p)</option>
                        <option value="3840,2160">3840x2160 (4K)</option>
                        <option value="custom">Custom</option>
                    </select>
                    <input type="text" id="customResolution" placeholder="e.g., 1920,1080"
                        style="display: none; margin-left: 10px;">
                </div>
                <div class="setting-item">
                    <label for="resolutionSecondary">Resolution (Secondary Monitor)<span class="tooltip-icon"
                            data-tooltip="Sets the secondary display resolution. Typically used for multi-monitor setups. Format: width,height (e.g., 0,0 if not used).">?</span></label>
                    <input type="text" id="resolutionSecondary" value="0,0">
                </div>
                <div class="setting-item">
                    <label for="monitor">Primary Monitor Index<span class="tooltip-icon"
                            data-tooltip="Specifies the index of the primary monitor to use. 0 is usually the main display.">?</span></label>
                    <input type="number" id="monitor" value="0" min="0">
                </div>
                <div class="setting-item">
                    <label for="monitorSecondary">Secondary Monitor Index<span class="tooltip-icon"
                            data-tooltip="Specifies the index of the secondary monitor to use. 0 if not used.">?</span></label>
                    <input type="number" id="monitorSecondary" value="0" min="0">
                </div>
                <div class="setting-item">
                    <label for="rendererMode">Renderer Mode<span class="tooltip-icon"
                            data-tooltip="Selects the rendering API: d3d11 (DirectX 11) or d3d12 (DirectX 12). d3d12 generally offers better performance on modern hardware.">?</span></label>
                    <select id="rendererMode">
                        <option value="d3d11">d3d11</option>
                        <option value="d3d12">d3d12</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="frameRate">Frame Rate / VSync<span class="tooltip-icon"
                            data-tooltip="Controls the game's frame rate and VSync behavior. 'No VSync' allows unlimited frames, 'Max device refresh rate' syncs with your monitor, and specific Hz options cap the frame rate.">?</span></label>
                    <select id="frameRate">
                        <option value="0">No VSync</option>
                        <option value="1">Max device refresh rate</option>
                        <option value="30">30Hz</option>
                        <option value="60">60Hz</option>
                        <option value="75">75Hz</option>
                        <option value="120">120Hz</option>
                        <option value="144">144Hz</option>
                        <option value="165">165Hz</option>
                        <option value="240">240Hz</option>
                        <option value="360">360Hz</option>
                        <option value="custom">Custom</option>
                    </select>
                    <input type="number" id="customFrameRate" placeholder="e.g., 144"
                        style="display: none; margin-left: 10px;">
                </div>
                <div class="setting-item">
                    <label for="disableDWM">Disable DWM (Fullscreen)<span class="tooltip-icon"
                            data-tooltip="Disables Desktop Window Manager for fullscreen mode, potentially improving performance but can cause issues.">?</span></label>
                    <input type="number" id="disableDWM" value="0" min="0" max="1">
                </div>
                <div class="setting-item">
                    <label for="vrr">Variable Refresh Rate (VRR)<span class="tooltip-icon"
                            data-tooltip="Enables Variable Refresh Rate (VRR) if your monitor and GPU support it, for smoother gameplay.">?</span></label>
                    <select id="vrr">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="extraGameFov">Extra Game FOV<span class="tooltip-icon"
                            data-tooltip="This setting adds to your in-game Field of View (FOV). For example, if your in-game FOV is 100 and this is set to 20, your effective FOV will be 120. This allows for a wider perspective of the game world.">?</span></label>
                    <input type="number" id="extraGameFov" value="0" step="1" min="0" max="70" style="flex: 1;">
                    <input type="range" id="extraGameFovSlider" value="0" min="0" max="70" step="1"
                        style="flex: 1; margin-left: 10px;">
                    <span id="extraGameFovValue" style="width: 40px; text-align: right;">0</span>
                </div>
                <div class="setting-item">
                    <label for="gammaFloat">Gamma<span class="tooltip-icon"
                            data-tooltip="Adjusts the gamma correction for display brightness and contrast.">?</span></label>
                    <input type="number" id="gammaFloat" value="1.00" step="0.01" min="0.5" max="3.0">
                </div>
            </div>
        </div>

        <div class="setting-section">
            <h2>Upscaling & Rendering</h2>
            <div class="settings-content">
                <div class="setting-item">
                    <label for="scale3D">3D Resolution Scale<span class="tooltip-icon"
                            data-tooltip="Adjusts the internal rendering resolution of 3D elements. Lower values improve performance at the cost of visual clarity.">?</span></label>
                    <input type="number" id="scale3D" value="1.000000" step="0.01" min="0.1" max="2.0">
                </div>
                <div class="setting-item">
                    <label for="upscaler">Upscaler<span class="tooltip-icon"
                            data-tooltip="Selects the upscaling technology used to render the game at a lower resolution and then upscale it to your display resolution, improving performance. Options include DLSS (NVIDIA), FSR (AMD), and XeSS (Intel).">?</span></label>
                    <select id="upscaler">
                        <option value="0">None</option>
                        <option value="1">Linear</option>
                        <option value="2">DLSS</option>
                        <option value="3">FSR</option>
                        <option value="4">FSR2</option>
                        <option value="5">XeSS</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="upscaling">Upscaling Quality<span class="tooltip-icon"
                            data-tooltip="Determines the quality level for the selected upscaling technology. Higher quality settings result in a sharper image but may reduce performance.">?</span></label>
                    <select id="upscaling">
                        <option value="0">Best Performance</option>
                        <option value="1">Balanced</option>
                        <option value="2">Best Quality</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="fsrSharpness">FSR Sharpness<span class="tooltip-icon"
                            data-tooltip="Adjusts the sharpness of the image when using FSR upscaling. Higher values can make the image appear crisper.">?</span></label>
                    <input type="number" id="fsrSharpness" value="1.000000" step="0.01" min="0.0" max="2.0">
                </div>
                <div class="setting-item">
                    <label for="frameAmplification">Frame Amplification<span class="tooltip-icon"
                            data-tooltip="Enables frame generation technologies like DLSS Frame Generation to increase frame rates.">?</span></label>
                    <select id="frameAmplification">
                        <option value="0">Off</option>
                        <option value="1">DLSS</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="asyncCompute">Async Compute<span class="tooltip-icon"
                            data-tooltip="Allows the GPU to process graphics and compute tasks simultaneously, potentially improving performance.">?</span></label>
                    <select id="asyncCompute">
                        <option value="0">Deny</option>
                        <option value="1">Allow (if supported)</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="setting-section">
            <h2>Quality Settings</h2>
            <div class="settings-content">
                <div class="setting-item">
                    <label for="textureQuality">Texture Quality<span class="tooltip-icon"
                            data-tooltip="Sets the resolution and detail of in-game textures. Higher quality requires more VRAM.">?</span></label>
                    <select id="textureQuality">
                        <option value="Low">Low</option>
                        <option value="Medium">Medium</option>
                        <option value="High">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="shadowsQuality">Shadows Quality<span class="tooltip-icon"
                            data-tooltip="Determines the quality of shadows cast by objects. Higher settings result in more realistic and detailed shadows.">?</span></label>
                    <select id="shadowsQuality">
                        <option value="0">PCF</option>
                        <option value="1">PCSS Low</option>
                        <option value="2">PCSS Medium</option>
                        <option value="3">PCSS High</option>
                        <option value="4">Raytraced</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="shadowsPreset">Shadows Preset<span class="tooltip-icon"
                            data-tooltip="Sets a preset for shadow quality. (Note: This might override individual shadow settings)">?</span></label>
                    <input type="number" id="shadowsPreset" value="0" min="0">
                </div>
                <div class="setting-item">
                    <label for="shadowMapSize">Shadow Map Size<span class="tooltip-icon"
                            data-tooltip="Sets the resolution of shadow maps, affecting the sharpness and detail of shadows. Higher values improve shadow quality.">?</span></label>
                    <input type="number" id="shadowMapSize" value="2048" min="256" step="256">
                </div>
                <div class="setting-item">
                    <label for="spotShadowMapSize">Spot Shadow Map Size<span class="tooltip-icon"
                            data-tooltip="Sets the resolution of shadow maps for spot lights, affecting their detail.">?</span></label>
                    <input type="number" id="spotShadowMapSize" value="4096" min="256" step="256">
                </div>
                <div class="setting-item">
                    <label for="spotShadowsQuality">Spot Shadows Quality<span class="tooltip-icon"
                            data-tooltip="Adjusts the quality of shadows cast by spot lights.">?</span></label>
                    <select id="spotShadowsQuality">
                        <option value="0">Low</option>
                        <option value="1">Medium</option>
                        <option value="2">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="grassQuality">Grass Quality<span class="tooltip-icon"
                            data-tooltip="Controls the density and detail of grass and foliage.">?</span></label>
                    <input type="number" id="grassQuality" value="0" min="0">
                </div>
                <div class="setting-item">
                    <label for="fogQuality">Fog Quality<span class="tooltip-icon"
                            data-tooltip="Adjusts the quality and density of volumetric fog effects.">?</span></label>
                    <select id="fogQuality">
                        <option value="0">Low</option>
                        <option value="1">Medium</option>
                        <option value="2">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="reflectionsQuality">Reflections Quality<span class="tooltip-icon"
                            data-tooltip="Controls the quality of reflections on surfaces. Higher settings provide more accurate and detailed reflections.">?</span></label>
                    <select id="reflectionsQuality">
                        <option value="0">Low</option>
                        <option value="1">Medium</option>
                        <option value="2">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="ambientOcclusion">Ambient Occlusion<span class="tooltip-icon"
                            data-tooltip="Enables or disables Ambient Occlusion, which adds realistic shadows where objects meet or block light.">?</span></label>
                    <select id="ambientOcclusion">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="ambientOcclusionQuality">Ambient Occlusion Quality<span class="tooltip-icon"
                            data-tooltip="Adjusts the quality of Ambient Occlusion effects.">?</span></label>
                    <select id="ambientOcclusionQuality">
                        <option value="0">Low</option>
                        <option value="1">Medium</option>
                        <option value="2">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="contactShadowsQuality">Contact Shadows Quality<span class="tooltip-icon"
                            data-tooltip="Controls the quality of small, subtle shadows that appear where objects are in direct contact.">?</span></label>
                    <select id="contactShadowsQuality">
                        <option value="0">None</option>
                        <option value="1">Low</option>
                        <option value="2">Medium</option>
                        <option value="3">High</option>
                        <option value="4">Very High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="gpuFxQuality">GPU FX Quality<span class="tooltip-icon"
                            data-tooltip="Adjusts the quality of GPU-accelerated visual effects, such as particles and explosions.">?</span></label>
                    <select id="gpuFxQuality">
                        <option value="0">Medium</option>
                        <option value="1">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="optSpotsCastShadows">Spot Lights Cast Shadows<span class="tooltip-icon"
                            data-tooltip="Enables or disables spot lights casting shadows.">?</span></label>
                    <select id="optSpotsCastShadows">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="lodQuality">LOD Quality<span class="tooltip-icon"
                            data-tooltip="Controls the level of detail (LOD) for distant objects. Higher quality means more detailed models further away.">?</span></label>
                    <select id="lodQuality">
                        <option value="0">Low</option>
                        <option value="1">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="lodMultiplier">LOD Multiplier<span class="tooltip-icon"
                            data-tooltip="Adjusts the distance at which different levels of detail are rendered. Higher values mean higher detail at greater distances.">?</span></label>
                    <input type="number" id="lodMultiplier" value="100" min="1" step="10">
                </div>
                <div class="setting-item">
                    <label for="anisoOptOut">Disable Optional Anisotropic Filtering<span class="tooltip-icon"
                            data-tooltip="Disables optional anisotropic filtering in some materials, potentially improving performance at the cost of some texture clarity.">?</span></label>
                    <select id="anisoOptOut">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="anisoOptMaxAnisotropy">Max Anisotropic Filtering<span class="tooltip-icon"
                            data-tooltip="Sets the level of Anisotropic Filtering, which improves the clarity of textures viewed at an angle.">?</span></label>
                    <select id="anisoOptMaxAnisotropy">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="4">4</option>
                        <option value="8">8</option>
                        <option value="16">16</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="setting-section">
            <h2>Ray Tracing Settings</h2>
            <div class="settings-content">
                <div class="setting-item">
                    <label for="rt_ao">Raytraced Ambient Occlusion<span class="tooltip-icon"
                            data-tooltip="Enables Raytraced Ambient Occlusion, providing more realistic and accurate ambient shadows.">?</span></label>
                    <select id="rt_ao">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="rt_ss">Raytraced Soft Shadows<span class="tooltip-icon"
                            data-tooltip="Enables Raytraced Soft Shadows, creating more realistic and softer shadow edges.">?</span></label>
                    <select id="rt_ss">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="rt_lit">Raytraced Flashlight<span class="tooltip-icon"
                            data-tooltip="Enables Raytraced Flashlight, making the flashlight's illumination more realistic.">?</span></label>
                    <select id="rt_lit">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="rt_giDif">Raytraced Global Illumination (Diffuse)<span class="tooltip-icon"
                            data-tooltip="Enables Raytraced Global Illumination for diffuse lighting, enhancing the realism of indirect lighting.">?</span></label>
                    <select id="rt_giDif">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="rt_giSpc">Raytraced Global Illumination (Specular)<span class="tooltip-icon"
                            data-tooltip="Enables Raytraced Global Illumination for specular lighting, improving the realism of reflections and highlights.">?</span></label>
                    <select id="rt_giSpc">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="voxelGiQuality">Voxel GI Quality<span class="tooltip-icon"
                            data-tooltip="Adjusts the quality of Voxel Global Illumination, affecting the realism of indirect lighting.">?</span></label>
                    <select id="voxelGiQuality">
                        <option value="0">Off</option>
                        <option value="1">Low</option>
                        <option value="2">Medium</option>
                        <option value="3">High</option>
                        <option value="4">Ultra</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="setting-section">
            <h2>Post-Processing & Visual Effects</h2>
            <div class="settings-content">

                <div class="setting-item">
                    <label for="motionBlur">Motion Blur<span class="tooltip-icon"
                            data-tooltip="Enables or disables the motion blur effect, which simulates blur during fast camera movements.">?</span></label>
                    <select id="motionBlur">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="motionBlurQuality">Motion Blur Quality<span class="tooltip-icon"
                            data-tooltip="Sets the quality of the motion blur effect.">?</span></label>
                    <select id="motionBlurQuality">
                        <option value="Low">Low</option>
                        <option value="Medium">Medium</option>
                        <option value="High">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="motionBlurIntensity">Motion Blur Intensity<span class="tooltip-icon"
                            data-tooltip="Adjusts the strength of the motion blur effect.">?</span></label>
                    <input type="range" id="motionBlurIntensity" value="0.50" min="0.0" max="1.0" step="0.01">
                    <span id="motionBlurIntensityValue">0.50</span>
                </div>
                <div class="setting-item">
                    <label for="bokeh">Bokeh<span class="tooltip-icon"
                            data-tooltip="Enables or disables the bokeh depth of field effect, which blurs out-of-focus areas.">?</span></label>
                    <select id="bokeh">
                        <option value="0">Off</option>
                        <option value="1">On</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="glowGlare">Glow Glare<span class="tooltip-icon"
                            data-tooltip="Enables or disables glow and glare effects from bright light sources.">?</span></label>
                    <select id="glowGlare">
                        <option value="0">Off</option>
                        <option value="1">On</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="glowStreaks">Glow Streaks<span class="tooltip-icon"
                            data-tooltip="Enables or disables light streaks emanating from bright light sources.">?</span></label>
                    <select id="glowStreaks">
                        <option value="0">Off</option>
                        <option value="1">On</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="lensFlare">Lens Flare<span class="tooltip-icon"
                            data-tooltip="Enables or disables lens flare effects when looking at bright light sources.">?</span></label>
                    <select id="lensFlare">
                        <option value="0">Off</option>
                        <option value="1">On</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="ssssQuality">SSSS Quality<span class="tooltip-icon"
                            data-tooltip="Adjusts the quality of Subsurface Scattering, which simulates light passing through translucent objects like skin.">?</span></label>
                    <select id="ssssQuality">
                        <option value="0">Low</option>
                        <option value="1">Medium</option>
                        <option value="2">High</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="chromaticAberration">Chromatic Aberration<span class="tooltip-icon"
                            data-tooltip="Enables or disables chromatic aberration, a visual effect that simulates lens distortion.">?</span></label>
                    <select id="chromaticAberration">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="filmGrain">Film Grain<span class="tooltip-icon"
                            data-tooltip="Enables or disables a film grain effect, adding a cinematic look.">?</span></label>
                    <select id="filmGrain">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="colorGrading">Color Grading<span class="tooltip-icon"
                            data-tooltip="Adjusts the overall color palette and tone of the game's visuals.">?</span></label>
                    <select id="colorGrading">
                        <option value="0">Normal</option>
                        <option value="1">E3</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="antiAliasing">Anti Aliasing<span class="tooltip-icon"
                            data-tooltip="Enables or disables anti-aliasing, which smooths jagged edges on objects.">?</span></label>
                    <select id="antiAliasing">
                        <option value="0">Disabled</option>
                        <option value="1">Enabled</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="antiAliasingMode">Anti Aliasing Mode<span class="tooltip-icon"
                            data-tooltip="Selects the anti-aliasing method. 'Sharp' might offer more clarity, while 'Stable' focuses on reducing temporal aliasing.">?</span></label>
                    <select id="antiAliasingMode">
                        <option value="0">Sharp</option>
                        <option value="1">Stable</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="colorBlindMode">Color Blind Mode<span class="tooltip-icon"
                            data-tooltip="Adjusts the color palette for different types of color blindness (Protanopia, Deuteranopia, Tritanopia).">?</span></label>
                    <select id="colorBlindMode">
                        <option value="0">None</option>
                        <option value="1">Protanopia</option>
                        <option value="2">Deuteranopia</option>
                        <option value="3">Tritanopia</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label for="reflex">Reflex<span class="tooltip-icon"
                            data-tooltip="Enables NVIDIA Reflex Low Latency mode, which reduces system latency for improved responsiveness.">?</span></label>
                    <select id="reflex">
                        <option value="0">Off</option>
                        <option value="1">On</option>
                        <option value="2">On + Boost</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="button-container">
            <button onclick="saveSettings()">Download Config File</button>
        </div>

        <div class="file-path">
            <p>Settings file location: C:\Users\*\Documents\dying light 2\out\settings\video.scr</p>
            <p>After downloading, you must manually move the `video.scr` file to the location above.</p>
        </div>
    </div>

    <script>
        // Define a comprehensive default configuration for Dying Light 2 settings.
        // These values represent common or balanced settings that a user might start with.
        const DEFAULT_SETTINGS = `RendererMode("d3d11")
AsyncCompute(1)
WindowMode(1)
Resolution(1920,1080)
Scale3D(1.000000)
FSR(1.000000)
Upscaler(0)
Upscaling(0)
Monitor(0)
ExtraGameFov(0.00)
DisableDWM(0)
TextureQuality("High")
ShadowsQuality(2)
ShadowMapSize(2048)
SpotShadowMapSize(4096)
GammaFloat(1.00)
GrassQuality(1)
FrameRate(1)
Reflex(0)
MotionBlur(1)
MotionBlurIntensity(0.50)
Bokeh(1)
GlowGlare(1)
GlowStreaks(1)
LensFlare(1)
SSSSQuality(1)
MotionBlurQuality("Medium")
ChromaticAberration(0)
FilmGrain(0)
ColorGrading(0)
AntiAliasing(1)
AntiAliasingMode(0)
FogQuality(1)
ReflectionsQuality(1)
ContactShadowsQuality(2)
SpotShadowsQuality(1)
AmbientOcclusion(1)
AmbientOcclusionQuality(1)
ColorBlindMode(0)
GpuFxQuality(0)
VoxelGiQuality(2)
LodQuality(1)
LodMultiplier(100)
AnisoOptMaxAnisotropy(8)
FrameAmplification(0)
Version(2000)`;

        document.addEventListener('DOMContentLoaded', function () {
            // Get references to DOM elements
            const dropArea = document.getElementById('dropArea');
            const fileInput = document.getElementById('fileInput');
            const motionBlurIntensity = document.getElementById('motionBlurIntensity');
            const motionBlurIntensityValue = document.getElementById('motionBlurIntensityValue');
            const feedbackMessage = document.getElementById('feedbackMessage');
            const defaultConfigLoadedBar = document.getElementById('defaultConfigLoadedBar');
            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;

            // Set initial theme based on localStorage or default to dark mode
            const currentTheme = localStorage.getItem('theme');
            if (currentTheme === 'light-mode') {
                body.classList.remove('dark-mode');
                themeToggle.textContent = 'Toggle Dark';
            } else { // Default to dark mode
                body.classList.add('dark-mode');
                themeToggle.textContent = 'Toggle Light';
            }

            // Toggle theme on button click
            themeToggle.addEventListener('click', function () {
                body.classList.toggle('dark-mode');
                if (body.classList.contains('dark-mode')) {
                    localStorage.setItem('theme', 'dark-mode');
                    themeToggle.textContent = 'Toggle Light';
                } else {
                    localStorage.setItem('theme', 'light-mode');
                    themeToggle.textContent = 'Toggle Dark';
                }
            });




            // Event listener for clicking on the drop area to open file dialog
            dropArea.addEventListener('click', () => fileInput.click());

            // Event listener for when a file is selected via the input dialog
            fileInput.addEventListener('change', (event) => {
                const files = event.target.files;
                if (files.length > 0) {
                    handleFiles(files);
                }
            });

            // Prevent default drag behaviors for drag and drop functionality
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.body.addEventListener(eventName, preventDefaults, false);
            });

            ['dragenter', 'dragover'].forEach(eventName => {
                document.body.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                document.body.addEventListener(eventName, unhighlight, false);
            });

            document.body.addEventListener('drop', handleDrop, false);

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            function highlight() {
                dropArea.classList.add('highlight');
            }

            function unhighlight() {
                dropArea.classList.remove('highlight');
            }

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            }

            function handleFiles(files) {
                updateFeedback('', 'info');
                unhighlight();

                if (files.length === 0) {
                    updateFeedback('No file selected.', 'error');
                    return;
                }

                const file = files[0];
                if (file.name !== 'video.scr') {
                    updateFeedback('Please select/drop a file named "video.scr".', 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function (e) {
                    try {
                        const content = e.target.result;
                        loadSettingsFromString(content);
                        dropArea.classList.add('success');

                        if (defaultConfigLoadedBar) {
                            defaultConfigLoadedBar.textContent = 'Your configuration has been loaded!';
                            defaultConfigLoadedBar.style.display = 'block';
                        }

                    } catch (error) {
                        updateFeedback('Error loading file: ' + error.message, 'error');
                        console.error('Error loading config file:', error);
                    }
                };
                reader.onerror = function () {
                    updateFeedback('Failed to read the file.', 'error');
                };
                reader.readAsText(file);
            }

            function validateDL2SettingsFile(settingsContent) {
                // Check for required Dying Light 2 settings to validate file authenticity
                const requiredSettings = [
                    'RendererMode',
                    'TextureQuality',
                    'Version',
                    'Resolution',
                    'WindowMode'
                ];

                const hasVersion2000 = settingsContent.includes('Version(2000)');
                const hasRequiredSettings = requiredSettings.every(setting =>
                    settingsContent.includes(setting + '(')
                );

                return hasVersion2000 && hasRequiredSettings;
            }

            function loadSettingsFromString(settingsContent, skipValidation = false) {
                // Validate that this is a Dying Light 2 settings file (skip for default settings)
                if (!skipValidation && !validateDL2SettingsFile(settingsContent)) {
                    updateFeedback('Invalid file: This does not appear to be a valid Dying Light 2 video.scr file. Please ensure you are uploading the correct settings file.', 'error');
                    return;
                }

                const lines = settingsContent.split('\n').filter(line => line.trim() !== '');

                // Reset all boolean select elements to default values
                document.querySelectorAll('select').forEach(select => {
                    if (['anisoOptOut', 'rt_ao', 'rt_ss', 'rt_lit', 'rt_giDif', 'rt_giSpc', 'vrr', 'optSpotsCastShadows'].includes(select.id)) {
                        select.value = '0'; // Set to Disabled by default
                    }
                });

                lines.forEach(line => {
                    const match = line.match(/!*([a-zA-Z0-9_]+)\((.*)\)/);
                    if (match) {
                        let key = match[1];
                        let value = match[2];

                        if (value.startsWith('"') && value.endsWith('"')) {
                            value = value.substring(1, value.length - 1);
                        }

                        let elementId;

                        if (key === "FSR") {
                            elementId = "fsrSharpness";
                        } else if (key === "SSSSQuality") {
                            elementId = "ssssQuality";
                        } else if (key === "Version") {
                            return;
                        } else if (key === "Resolution") {
                            elementId = "resolution";
                            const resolutionElement = document.getElementById(elementId);
                            const customResolutionElement = document.getElementById('customResolution');
                            if (resolutionElement && customResolutionElement) {
                                if (['1280,720', '1920,1080', '2560,1440', '3840,2160'].includes(value)) {
                                    resolutionElement.value = value;
                                    customResolutionElement.style.display = 'none';
                                } else {
                                    resolutionElement.value = 'custom';
                                    customResolutionElement.value = value;
                                    customResolutionElement.style.display = 'inline-block';
                                }
                            }
                            return;
                        } else if (key === "ResolutionSecondary") {
                            elementId = key.charAt(0).toLowerCase() + key.slice(1);
                        } else if (key === "WindowOffset") {
                            const [offsetX, offsetY] = value.split(',').map(Number);
                            document.getElementById('windowOffsetX').value = offsetX;
                            document.getElementById('windowOffsetY').value = offsetY;
                            return;
                        } else if (key === "FrameRate") {
                            elementId = "frameRate";
                            const frameRateElement = document.getElementById(elementId);
                            const customFrameRateElement = document.getElementById('customFrameRate');
                            if (frameRateElement && customFrameRateElement) {
                                if (['0', '1', '30', '60', '75', '120', '144', '165', '240', '360'].includes(value)) {
                                    frameRateElement.value = value;
                                    customFrameRateElement.style.display = 'none';
                                } else {
                                    frameRateElement.value = 'custom';
                                    customFrameRateElement.value = value;
                                    customFrameRateElement.style.display = 'inline-block';
                                }
                            }
                            return;
                        } else if (key === "ShadowsPreset") {
                            elementId = "shadowsPreset";
                        } else if (key === "AnisoOptOut") {
                            elementId = "anisoOptOut";
                            const selectElement = document.getElementById(elementId);
                            if (selectElement && selectElement.tagName === 'SELECT') {
                                selectElement.value = '1'; // Set to Enabled
                            }
                            return;
                        } else if (key.startsWith('RT_') || key === 'Vrr') {
                            elementId = key.charAt(0).toLowerCase() + key.slice(1);
                            const selectElement = document.getElementById(elementId);
                            if (selectElement && selectElement.tagName === 'SELECT') {
                                selectElement.value = '1'; // Set to Enabled
                            }
                            return;
                        } else {
                            elementId = key.charAt(0).toLowerCase() + key.slice(1);
                        }

                        const element = document.getElementById(elementId);

                        if (element) {
                            if (element.tagName === 'SELECT') {
                                element.value = value;
                            } else if (element.type === 'range' || element.type === 'number') {
                                element.value = parseFloat(value);
                                if (element.type === 'range') {
                                    document.getElementById(element.id + 'Value').textContent = parseFloat(value).toFixed(2);
                                }
                            } else {
                                element.value = value;
                            }
                        } else {
                            console.warn(`Element with ID '${elementId}' not found for key '${key}'`);
                        }
                    }
                });
            }

            function updateFeedback(message, type = 'info') {
                feedbackMessage.textContent = message;
                feedbackMessage.className = 'feedback-message ' + type;
            }


            // FOV slider elements
            const extraGameFov = document.getElementById('extraGameFov');
            const extraGameFovSlider = document.getElementById('extraGameFovSlider');
            const extraGameFovValue = document.getElementById('extraGameFovValue');

            const resolutionSelect = document.getElementById('resolution');
            const customResolutionInput = document.getElementById('customResolution');
            const frameRateSelect = document.getElementById('frameRate');
            const customFrameRateInput = document.getElementById('customFrameRate');



            // FOV slider synchronization
            extraGameFov.addEventListener('input', function () {
                let value = parseInt(this.value, 10);
                if (isNaN(value)) {
                    value = 0;
                }
                if (value < 0) value = 0;
                if (value > 70) value = 70;
                this.value = value;
                extraGameFovSlider.value = value;
                extraGameFovValue.textContent = value;
            });

            extraGameFovSlider.addEventListener('input', function () {
                let value = parseInt(this.value, 10);
                extraGameFov.value = value;
                extraGameFovValue.textContent = value;
            });

            // Initialize FOV value display
            extraGameFovValue.textContent = parseInt(extraGameFov.value, 10);

            motionBlurIntensity.addEventListener('input', function () {
                motionBlurIntensityValue.textContent = parseFloat(this.value).toFixed(2);
            });



            resolutionSelect.addEventListener('change', function () {
                customResolutionInput.style.display = (this.value === 'custom') ? 'inline-block' : 'none';
            });

            if (resolutionSelect.value === 'custom') {
                customResolutionInput.style.display = 'inline-block';
            }

            frameRateSelect.addEventListener('change', function () {
                customFrameRateInput.style.display = (this.value === 'custom') ? 'inline-block' : 'none';
            });

            if (frameRateSelect.value === 'custom') {
                customFrameRateInput.style.display = 'inline-block';
            }

            const settingSearch = document.getElementById('settingSearch');
            settingSearch.addEventListener('keyup', function () {
                const searchTerm = settingSearch.value.toLowerCase();
                const settingSections = document.querySelectorAll('.setting-section');

                settingSections.forEach(section => {
                    let sectionHasVisibleItems = false;
                    const settingItems = section.querySelectorAll('.setting-item');
                    const sectionTitle = section.querySelector('h2').textContent.toLowerCase();

                    settingItems.forEach(item => {
                        const label = item.querySelector('label').textContent.toLowerCase();
                        if (sectionTitle.includes(searchTerm) || label.includes(searchTerm)) {
                            item.style.display = 'flex';
                            sectionHasVisibleItems = true;
                        } else {
                            item.style.display = 'none';
                        }
                    });

                    if (sectionHasVisibleItems) {
                        section.style.display = 'block';
                        // Auto-expand sections that contain matching settings
                        if (searchTerm.length > 0) {
                            section.classList.add('open');
                        }
                    } else {
                        section.style.display = 'none';
                    }
                });

                // If search is cleared, restore original collapsed state
                if (searchTerm.length === 0) {
                    settingSections.forEach(section => {
                        section.style.display = 'block';
                        section.classList.remove('open');
                        const settingItems = section.querySelectorAll('.setting-item');
                        settingItems.forEach(item => {
                            item.style.display = 'flex';
                        });
                    });
                }
            });

            // Collapsible sections
            document.querySelectorAll('.setting-section h2').forEach(header => {
                header.addEventListener('click', () => {
                    const section = header.parentElement;
                    section.classList.toggle('open');
                });
            });

            // Toggle all categories functionality
            const expandAllBtn = document.getElementById('expandAllBtn');
            let allExpanded = false;

            expandAllBtn.addEventListener('click', () => {
                const sections = document.querySelectorAll('.setting-section');

                if (allExpanded) {
                    // Collapse all sections
                    sections.forEach(section => {
                        section.classList.remove('open');
                    });
                    expandAllBtn.textContent = 'Show All Categories';
                    allExpanded = false;
                } else {
                    // Expand all sections
                    sections.forEach(section => {
                        section.classList.add('open');
                    });
                    expandAllBtn.textContent = 'Hide All Categories';
                    allExpanded = true;
                }
            });
        });

        // Load default settings when the page is first loaded
        try {
            loadSettingsFromString(DEFAULT_SETTINGS, true);
            if (defaultConfigLoadedBar) {
                defaultConfigLoadedBar.textContent = 'Default configuration loaded.';
                defaultConfigLoadedBar.style.display = 'block';
                setTimeout(() => {
                    defaultConfigLoadedBar.style.display = 'none';
                }, 3000);
            }
        } catch (error) {
            console.error('Error loading default settings:', error);
        }

        function getValue(id, type = 'string') {
            const element = document.getElementById(id);
            if (!element) return '';

            let value;
            if (type === 'number') {
                value = element.value;
            } else {
                value = element.value;
                if (typeof value === 'string' && !value.startsWith('"') && !value.endsWith('"') && isNaN(value)) {
                    value = `"${value}"`;
                }
            }
            return value;
        }

        function getFlagSetting(id, originalKey) {
            const selectElement = document.getElementById(id);
            if (selectElement && selectElement.value === '1') {
                return `${originalKey}()\n`;
            }
            return '';
        }

        function saveSettings() {
            let settingsOutput = '';

            settingsOutput += `RendererMode(${getValue('rendererMode')})\n`;
            settingsOutput += `AsyncCompute(${getValue('asyncCompute', 'number')})\n`;
            settingsOutput += `WindowMode(${getValue('windowMode', 'number')})\n`;
            settingsOutput += `WindowOffset(${getValue('windowOffsetX', 'number')},${getValue('windowOffsetY', 'number')})\n`;

            const resolutionSelect = document.getElementById('resolution');
            const customResolutionInput = document.getElementById('customResolution');
            let primaryResolutionValue = (resolutionSelect.value === 'custom') ? customResolutionInput.value : resolutionSelect.value;
            settingsOutput += `Resolution(${primaryResolutionValue})\n`;

            settingsOutput += `ResolutionSecondary(${document.getElementById('resolutionSecondary').value})\n`;
            settingsOutput += `Scale3D(${parseFloat(document.getElementById('scale3D').value).toFixed(6)})\n`;
            settingsOutput += `FSR(${parseFloat(document.getElementById('fsrSharpness').value).toFixed(6)})\n`;
            settingsOutput += `Upscaler(${getValue('upscaler', 'number')})\n`;
            settingsOutput += `Upscaling(${getValue('upscaling', 'number')})\n`;
            settingsOutput += `Monitor(${getValue('monitor', 'number')})\n`;
            settingsOutput += `MonitorSecondary(${getValue('monitorSecondary', 'number')})\n`;
            settingsOutput += `ExtraGameFov(${parseFloat(document.getElementById('extraGameFov').value).toFixed(2)})\n`;
            settingsOutput += `DisableDWM(${getValue('disableDWM', 'number')})\n`;

            settingsOutput += getFlagSetting('rt_ao', 'RT_AO');
            settingsOutput += getFlagSetting('rt_ss', 'RT_SS');
            settingsOutput += getFlagSetting('rt_lit', 'RT_Lit');
            settingsOutput += getFlagSetting('rt_giDif', 'RT_GiDif');
            settingsOutput += getFlagSetting('rt_giSpc', 'RT_GiSpc');

            settingsOutput += `TextureQuality(${getValue('textureQuality')})\n`;
            settingsOutput += `ShadowsPreset(${getValue('shadowsPreset', 'number')})\n`;
            settingsOutput += `ShadowsQuality(${getValue('shadowsQuality', 'number')})\n`;
            settingsOutput += `ShadowMapSize(${getValue('shadowMapSize', 'number')})\n`;
            settingsOutput += `SpotShadowMapSize(${getValue('spotShadowMapSize', 'number')})\n`;
            settingsOutput += `GammaFloat(${parseFloat(document.getElementById('gammaFloat').value).toFixed(2)})\n`;
            settingsOutput += `GrassQuality(${getValue('grassQuality', 'number')})\n`;

            const frameRateSelect = document.getElementById('frameRate');
            const customFrameRateInput = document.getElementById('customFrameRate');
            let frameRateValue = (frameRateSelect.value === 'custom') ? customFrameRateInput.value : frameRateSelect.value;
            settingsOutput += `FrameRate(${frameRateValue})\n`;

            settingsOutput += getFlagSetting('vrr', 'Vrr');
            settingsOutput += `Reflex(${getValue('reflex', 'number')})\n`;

            settingsOutput += `MotionBlur(${getValue('motionBlur', 'number')})\n`;
            settingsOutput += `MotionBlurQuality(${getValue('motionBlurQuality')})\n`;
            settingsOutput += `MotionBlurIntensity(${parseFloat(document.getElementById('motionBlurIntensity').value).toFixed(2)})\n`;
            settingsOutput += `Bokeh(${getValue('bokeh', 'number')})\n`;
            settingsOutput += `GlowGlare(${getValue('glowGlare', 'number')})\n`;
            settingsOutput += `GlowStreaks(${getValue('glowStreaks', 'number')})\n`;
            settingsOutput += `LensFlare(${getValue('lensFlare', 'number')})\n`;
            settingsOutput += `SSSSQuality(${getValue('ssssQuality', 'number')})\n`;
            settingsOutput += `ChromaticAberration(${getValue('chromaticAberration', 'number')})\n`;
            settingsOutput += `FilmGrain(${getValue('filmGrain', 'number')})\n`;
            settingsOutput += `ColorGrading(${getValue('colorGrading', 'number')})\n`;
            settingsOutput += `AntiAliasing(${getValue('antiAliasing', 'number')})\n`;
            settingsOutput += `AntiAliasingMode(${getValue('antiAliasingMode', 'number')})\n`;
            settingsOutput += `FogQuality(${getValue('fogQuality', 'number')})\n`;
            settingsOutput += `ReflectionsQuality(${getValue('reflectionsQuality', 'number')})\n`;
            settingsOutput += `ContactShadowsQuality(${getValue('contactShadowsQuality', 'number')})\n`;
            settingsOutput += `SpotShadowsQuality(${getValue('spotShadowsQuality', 'number')})\n`;
            settingsOutput += `AmbientOcclusion(${getValue('ambientOcclusion', 'number')})\n`;
            settingsOutput += `AmbientOcclusionQuality(${getValue('ambientOcclusionQuality', 'number')})\n`;
            settingsOutput += `ColorBlindMode(${getValue('colorBlindMode', 'number')})\n`;
            settingsOutput += `GpuFxQuality(${getValue('gpuFxQuality', 'number')})\n`;
            settingsOutput += `VoxelGiQuality(${getValue('voxelGiQuality', 'number')})\n`;
            settingsOutput += `OptSpotsCastShadows(${getValue('optSpotsCastShadows', 'number')})\n`;

            settingsOutput += getFlagSetting('anisoOptOut', 'AnisoOptOut');

            settingsOutput += `LodQuality(${getValue('lodQuality', 'number')})\n`;
            settingsOutput += `LodMultiplier(${getValue('lodMultiplier', 'number')})\n`;
            settingsOutput += `AnisoOptMaxAnisotropy(${getValue('anisoOptMaxAnisotropy', 'number')})\n`;
            settingsOutput += `FrameAmplification(${getValue('frameAmplification', 'number')})\n`;
            settingsOutput += `Version(2000)\n`;

            console.log("Generated video.scr content:\n" + settingsOutput);

            alert("Settings file will be downloaded. You must manually move it to:\nC:\\Users\\**\\Documents\\dying light 2\\out\\settings\\video.scr");

            const blob = new Blob([settingsOutput], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'video.scr';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>

</body>

</html>
